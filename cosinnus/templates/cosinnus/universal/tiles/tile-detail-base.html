{% import "include/macros.html" as macros %}

<div class="tile-detail tile-{{ type }} {% if selected %}selected{% endif %}" {% if noModel %}style="display: none;"{% endif %}>
    <div class="tile-close-button">
        <i class="fa fa-fw fa-close"></i>
    </div>
    
    {% block content %}
    
        {% block type_area %}
            <div class="tile-header-section">
               {{ macros.typeLabel(type, singular=1) }}
                <span style="font-size:8px;color:#ccc;">score: {{relevance}}</span> {# TODO: delete me #}
                
                {% if not isSmall and controlView.portalInfo.current != portal %}
                    <div class="pull-right">
                        <a class="portal-inlink uncolored-link" href="{{ controlView.portalInfo[portal].domain }}" target="_blank" title="{{ controlView.portalInfo[portal].name }}">
                            {# <img src="{{ controlView.portalInfo[portal].image_url }}" style="width:20px;"> #}
                            {{ controlView.portalInfo[portal].name }}
                        </a> 
                    </div>
                {% endif %}
            </div>
        {% endblock %}
        
        {% block header_image %}
            <div class="tile-section header-image">
                <div class="dual-tile-image {% if not backgroundImageLargeUrl %}image-placeholder-background-{{ type }}{% endif %}">
                    {% if backgroundImageLargeUrl %}
                        <img class="tile-image tile-image-background" src="{{ backgroundImageLargeUrl }}" /> {# TODO: put in wallpaper/placeholder img #}
                    {% endif %}
                    <img class="floating-tile-image" src="{{ iconImageUrl }}" />
                </div>
            </div>
        {% endblock header_image %}
        
        
        {% block title %}
            <div class="tile-section title">
                <a href="{{ url }}" target="_blank">
                    {{ title }}
                    <i class="fa fa-external link"></i>
                </a>
            </div>
        {% endblock title %}
        
        {% block top_line %}
            {% if address or group_slug and group_name and portal %}
                <div class="tile-section top-line one-line">
		            {% block top_line_group %}
		                {% if group_slug and group_name and portal %}
			                <div class="pale-color one-line">
					            {% if type == "projects" %}
					                {{ macros.typeLabel("groups", singular=1, useStyles=0, colon=1, showIcon=0) }}
					                {{ macros.resultLink(portal, group_slug, group_name, "groups") }}
					            {% else %}
					                {{ macros.typeLabel("projects", singular=1, useStyles=0, colon=1, showIcon=0) }}
					                {{ macros.resultLink(portal, group_slug, group_name, "projects") }}
					            {% endif %}
					        </div>
				        {% endif %}
		            {% endblock top_line_group %}
	                
		            {% block top_line_address %}
		                {% if address and not type == "events" %}
                            <div class="address">{{ address }} ((link me?))</div>
		                {% endif %}
		            {% endblock top_line_address %}
	            </div>
            {% endif %}
        {% endblock top_line %}
        
        
        {% block additional_top_line %}
        {% endblock additional_top_line %}
        
        
        {% block topic_line %}
	        <div class="tile-section topic-line one-line">
	            <span class="pale-color">Topics:</span> 
	            {% for topic in topics %}
	                <a class="topic-filter-link " data-topic-id="{{ topic }}">{{ controlView.allTopics[topic] }}</a>{% if not loop.last %},{% endif %}
	            {% endfor %}
	        </div>
        {% endblock topic_line %}
        
        
        {% block action_buttons %}
        {% endblock action_buttons %}
        
        
        {% block description %}
            <div class="tile-section description">
                {{description|safe}}
                <br/>
                (( TODO: make me click-expandable ))
            </div>
        {% endblock description %}
        
        
        {% block related_content %}
        {% endblock related_content %}
        
        
        {% block contact %}
        {% endblock contact %}
        
        
	    <div class="tile-detail-link">
		    <img class="tile-image" src="{{imageUrl}}" />
		    <br/>
	        <a href="{{url}}" target="_blank">{{title}}</a>
	    </div>
	    <div>{{ title }} ({{id}})</div>
	    <div class="description">{{description|safe}}</div>
	    {% if lat and lon %}
	        <div>This result has a location (but may be off map) - Should we add a link to "show on map?"</div>
	    {% else %}
	        <div>This result has no location</div>
	    {% endif %}
	    
	    {% if topics|length > 0 %}
	        <div class="topics">
	            Topics: 
	            {% for topic in topics %}
	                <a class="topic-filter-link" data-topic-id="{{ topic }}">{{ controlView.allTopics[topic] }}</a>{% if not loop.last %},{% endif %}
	            {% endfor %}
	        </div>
	    {% endif %}
	    
	    <div>
		    Link: <a href="{% if type == "people" %}{{ controlView.portalInfo[portal].domain }}{% endif %}{{ url }}" target="_blank">Visit Page!</a>
	    </div>
	    
	{% endblock content %}
</div>
